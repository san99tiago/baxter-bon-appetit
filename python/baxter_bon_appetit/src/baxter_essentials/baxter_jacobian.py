#!/usr/bin/env python

# Built-in imports
import math

# General module imports
import numpy as np


class BaxterJacobian:
    """
    Calculate Baxter's Jacobian from w0 to tool.
        Remark: the expression used was calculated based on the article 
        "Baxter Humanoid Robot Kinematics" from Ohio University.

    :param baxter_distances: list of baxter_distances from BaxterClass.
    :param joint_values: list of joint-values.
        example: [value_limb_s0, value_limb_s1, value_limb_left_e0,
                value_limb_left_e1, value_limb_left_w0, value_limb_left_w1,
                value_limb_left_w2]
    :param limb: arm to calculate jacobian.
        example: "left" or "right".
    """

    def __init__(self, baxter_distances, joint_values, limb):
        self.baxter_distances = baxter_distances
        self.joint_values = joint_values
        self.limb = limb

    def calculate_jacobian(self):

        t1 = self.joint_values[0]
        t2 = self.joint_values[1]
        t3 = self.joint_values[2]
        t4 = self.joint_values[3]
        t5 = self.joint_values[4]
        t6 = self.joint_values[5]

        L1 = self.baxter_distances[1]
        L2 = self.baxter_distances[2]
        L3 = self.baxter_distances[3]
        L4 = self.baxter_distances[4]
        L5 = self.baxter_distances[5]

        if (self.limb == "left"):
            return "LEFT JACOBIAN NOT DEFINED"

        return np.array([[ (math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(math.sin(t3)*(math.cos(t4)*(L1 + L2*math.cos(t2)) + math.cos(t2)*(L4 + L3*math.sin(t4))) + L5*math.sin(t5)*(math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4))) + (math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(math.sin(t3)*(math.sin(t4)*(L1 + L2*math.cos(t2)) - L3*math.cos(t2)*math.cos(t4)) + L5*math.sin(t5)*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) - L5*math.cos(t2)*math.cos(t5)*math.sin(t3)) - (math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(L4*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) - math.cos(t3)*(L1 + L2*math.cos(t2)) + L3*math.sin(t2) + L5*math.cos(t5)*(math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4))), (math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(math.cos(t3)*(L4 + L2*math.cos(t4) + L3*math.sin(t4)) - L5*math.sin(t3)*math.sin(t4)*math.sin(t5)) - (math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(math.cos(t3)*(L3*math.cos(t4) + L5*math.cos(t5) - L2*math.sin(t4)) - L5*math.cos(t4)*math.sin(t3)*math.sin(t5)) - math.sin(t3)*(math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(L2 + L4*math.cos(t4) - L5*math.cos(t5)*math.sin(t4)), (math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(L3 + L4*math.sin(t4) + L5*math.cos(t4)*math.cos(t5)) - L5*math.cos(t4)*math.sin(t5)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - L5*math.sin(t4)*math.sin(t5)*(math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))), L4*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - L5*math.cos(t5)*(math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))), L5*math.cos(t5)*(math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - L5*math.sin(t5)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))),                                                                                                                                                                                                                                                                               0, 0],
        [ (math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) + math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(L4*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) - math.cos(t3)*(L1 + L2*math.cos(t2)) + L3*math.sin(t2) + L5*math.cos(t5)*(math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4))) - (math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) + math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(math.sin(t3)*(math.sin(t4)*(L1 + L2*math.cos(t2)) - L3*math.cos(t2)*math.cos(t4)) + L5*math.sin(t5)*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) - L5*math.cos(t2)*math.cos(t5)*math.sin(t3)) - (math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(math.sin(t3)*(math.cos(t4)*(L1 + L2*math.cos(t2)) + math.cos(t2)*(L4 + L3*math.sin(t4))) + L5*math.sin(t5)*(math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4))), (math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) + math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(math.cos(t3)*(L3*math.cos(t4) + L5*math.cos(t5) - L2*math.sin(t4)) - L5*math.cos(t4)*math.sin(t3)*math.sin(t5)) - (math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(math.cos(t3)*(L4 + L2*math.cos(t4) + L3*math.sin(t4)) - L5*math.sin(t3)*math.sin(t4)*math.sin(t5)) + math.sin(t3)*(math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) + math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(L2 + L4*math.cos(t4) - L5*math.cos(t5)*math.sin(t4)), L5*math.cos(t4)*math.sin(t5)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - (math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) + math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(L3 + L4*math.sin(t4) + L5*math.cos(t4)*math.cos(t5)) + L5*math.sin(t4)*math.sin(t5)*(math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) + math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))), L5*math.cos(t5)*(math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) + math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - L4*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))), L5*math.sin(t5)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - L5*math.cos(t5)*(math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) + math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))),                                                                                                                                                                                                                                                                               0, 0],
        [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              0,                                                                                                                                                                                                                                                                                                                           (math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4))*(math.cos(t3)*(L4 + L2*math.cos(t4) + L3*math.sin(t4)) - L5*math.sin(t3)*math.sin(t4)*math.sin(t5)) + (math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4))*(math.cos(t3)*(L3*math.cos(t4) + L5*math.cos(t5) - L2*math.sin(t4)) - L5*math.cos(t4)*math.sin(t3)*math.sin(t5)) - math.cos(t2)*math.sin(t3)**2*(L2 + L4*math.cos(t4) - L5*math.cos(t5)*math.sin(t4)),                                                                                                                                                                                                                                                                                                                                                                                                                  math.cos(t2)*(L3*math.sin(t3) + L5*math.cos(t3)*math.sin(t5) + L4*math.sin(t3)*math.sin(t4) + L5*math.cos(t4)*math.cos(t5)*math.sin(t3)),                                                                                                                                                                                                                                     L4*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) + L5*math.cos(t5)*(math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4)),                                                                                                                                                                                                   L5*math.cos(t2)*math.cos(t5)*math.sin(t3) - L5*math.sin(t5)*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)),                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0],
        [                                                                                                                                                                                                                                                                                                                        (math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) - (math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))*(math.sin(t2)*math.sin(t4) + math.cos(t2)*math.cos(t3)*math.cos(t4)) + math.cos(t2)*math.sin(t3)*(math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   math.sin(t1 + 0.7854),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -math.cos(t1 + 0.7854)*math.cos(t2),                                                                                                                                                                                                                                               math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)),                                                                                                                           math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)), math.cos(t5)*(math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.sin(t5)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))),   math.cos(t6)*(math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.sin(t5)*math.sin(t6)*(math.cos(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t5)*math.sin(t6)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)) + math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1))) + math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)))],
        [                                                                                                                                                                                                                                                                                                                        (math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) + math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(math.sin(t2)*math.sin(t4) + math.cos(t2)*math.cos(t3)*math.cos(t4)) - (math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) - math.cos(t2)*math.sin(t3)*(math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) + math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -math.cos(t1 + 0.7854),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -math.sin(t1 + 0.7854)*math.cos(t2),                                                                                                                                                                                                                                             - math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)),                                                                                                                         - math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)), math.sin(t5)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t5)*(math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) + math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))), - math.cos(t6)*(math.sin(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) + math.cos(t2)*math.cos(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.sin(t5)*math.sin(t6)*(math.cos(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) + math.sin(t2)*math.sin(t3)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t5)*math.sin(t6)*(math.cos(t4)*(math.sin(t3)*(0.7071*math.cos(t1) - 0.7071*math.sin(t1)) - math.cos(t3)*math.sin(t2)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1))) - math.cos(t2)*math.sin(t4)*(0.7071*math.cos(t1) + 0.7071*math.sin(t1)))],
        [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4))*(math.sin(t2)*math.sin(t4) + math.cos(t2)*math.cos(t3)*math.cos(t4)) + (math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4))**2 + math.cos(t2)**2*math.sin(t3)**2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -math.sin(t2),                                                                                                                                                                                                                                                                                                                             math.cos(t2)*math.sin(t3),                                                                                                                                                                                                                                           - math.cos(t4)*math.sin(t2) - math.cos(t2)*math.cos(t3)*math.sin(t4),                                                                                                                                                                                                   math.cos(t2)*math.cos(t5)*math.sin(t3) - math.sin(t5)*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)),                                                                                                                                                                                                                                                                                                                       math.cos(t5)*math.sin(t6)*(math.sin(t2)*math.sin(t4) - math.cos(t2)*math.cos(t3)*math.cos(t4)) - math.cos(t6)*(math.cos(t4)*math.sin(t2) + math.cos(t2)*math.cos(t3)*math.sin(t4)) + math.cos(t2)*math.sin(t3)*math.sin(t5)*math.sin(t6)]])


    # bj = BaxterJacobian(bc.BaxterClass().baxter_distances, [0, 0, 0, 0, 0, 0, 0], "left")
    # print(bj.calculate_jacobian())
